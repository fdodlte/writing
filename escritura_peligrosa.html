
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Escritura Peligrosa - Modo Hardcore</title>
  <style>
    body {
      background: #000;
      color: #fff;
      font-family: monospace;
      font-size: 18px;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    #intro {
      padding: 20px;
      text-align: center;
      font-size: 20px;
      line-height: 1.5;
    }
    #emailForm {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    input[type="email"] {
      padding: 10px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background-color: #fff;
      color: #000;
      cursor: pointer;
      border-radius: 5px;
    }
    #timer {
      text-align: center;
      font-size: 24px;
      margin: 10px;
    }
    #editor {
      flex-grow: 1;
      padding: 20px;
      border: none;
      outline: none;
      background: #000;
      color: #fff;
      resize: none;
      width: 100%;
      height: 100%;
      display: none;
    }
    #saveBtn {
      display: none;
      background: #fff;
      color: #000;
      padding: 10px;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <div id="intro">
    Esta app nació de mi ritual diario de escritura: 5 minutos sin parar, sin corregir, sin excusas.<br>
    Si te detienes por más de 5 segundos, todo se borra.<br><br>
    ¿Listo para intentarlo? Deja tu correo y empieza:
  </div>
  <div id="emailForm">
    <input type="email" id="emailInput" placeholder="Tu correo" required>
    <button onclick="startWriting()">Comenzar</button>
  </div>
  <div id="timer" style="display:none;">5:00</div>
  <textarea id="editor" placeholder="Empieza a escribir..."></textarea>
  <button id="saveBtn">Guardar texto</button>

  <script>
    const editor = document.getElementById("editor");
    const timerDisplay = document.getElementById("timer");
    const saveBtn = document.getElementById("saveBtn");
    const intro = document.getElementById("intro");
    const emailForm = document.getElementById("emailForm");

    let countdown = 300;
    let idleTime = 0;
    let writing = true;
    let timerInterval, idleInterval;

    function startWriting() {
      const email = document.getElementById("emailInput").value;
      if (!email) {
        alert("Por favor ingresa tu correo.");
        return;
      }

      intro.style.display = "none";
      emailForm.style.display = "none";
      editor.style.display = "block";
      timerDisplay.style.display = "block";

      function updateTimer() {
        let minutes = Math.floor(countdown / 60);
        let seconds = countdown % 60;
        timerDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        if (countdown === 0) {
          writing = false;
          clearInterval(timerInterval);
          clearInterval(idleInterval);
          editor.disabled = true;
          saveBtn.style.display = "block";
        }
        countdown--;
      }

      function resetIdleTimer() {
        idleTime = 0;
      }

      editor.addEventListener("input", resetIdleTimer);

      idleInterval = setInterval(() => {
        if (!writing) return;
        idleTime++;
        if (idleTime >= 5) {
          editor.value = "";
          idleTime = 0;
        }
      }, 1000);

      timerInterval = setInterval(updateTimer, 1000);

      saveBtn.addEventListener("click", () => {
        const blob = new Blob([editor.value], { type: "text/plain" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "escritura.txt";
        link.click();
      });

      editor.focus();
    }
  </script>
</body>
</html>
